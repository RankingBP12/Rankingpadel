import{i as V,r as u,A as H,j as e,F as K,k as Q,l as W,m as X,n as Y,q as Z,t as _,a as F,d as P,b as ee,s as te,u as se,c as ne,v as A,g as re,f as ae}from"./index-DRcmzawD.js";import{G as oe}from"./nombre-BYGSWZGL.js";var G={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(p){(function(){var c={}.hasOwnProperty;function m(){for(var r="",o=0;o<arguments.length;o++){var j=arguments[o];j&&(r=h(r,g(j)))}return r}function g(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return m.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var j in r)c.call(r,j)&&r[j]&&(o=h(o,j));return o}function h(r,o){return o?r?r+" "+o:r+o:r}p.exports?(m.default=m,p.exports=m):window.classNames=m})()})(G);var ie=G.exports;const k=V(ie),de=()=>{const{updateJugadores:p,jugadores:c}=u.useContext(H),[m,g]=u.useState([]),[h,r]=u.useState(""),[o,j]=u.useState(""),[f,M]=u.useState(""),[a,b]=u.useState(null),[w,R]=u.useState(!1),[$,v]=u.useState(""),[D,T]=u.useState(null),[N,L]=u.useState(null);u.useState(""),u.useEffect(()=>{E(o,h,f)},[h,o,f,c]);const I=t=>{r(t.target.value)},S=t=>{j(t)},C=t=>{M(t)},E=(t,d,s)=>{try{let l=Object.keys(c).filter(n=>c[n]!==null&&c[n]!==void 0).map(n=>({id:c[n].id,...c[n]})).filter(n=>n.name&&n.name.toLowerCase().includes(d.toLowerCase()));t&&(l=l.filter(n=>n.gender===t)),s==="greater"?l=l.filter(n=>n.points>0).sort((n,x)=>x.points-n.points):s==="less"?l=l.filter(n=>n.points>0).sort((n,x)=>n.points-x.points):s==="zero"&&(l=l.filter(n=>n.points===0).sort((n,x)=>n.name.localeCompare(x.name))),g(l)}catch(i){console.error("Error filtering players:",i),g([])}},y=t=>{const{name:d,value:s}=t.target;a&&b(i=>({...i,[d]:s}))},U=t=>{b({...t})},q=()=>{if(a){const t=F(P,`jugadores/${a.id}`);if(N){const d=ee(te,`jugadores/${a.id}/photo.jpg`);se(d,N).then(s=>ne(s.ref)).then(s=>(a.photoURL=s,O(t,a))).catch(s=>{console.error("Error uploading photo: ",s),v("Error al subir la foto.")})}else O(t,a)}},O=(t,d)=>{const s={...d};N||delete s.photoURL,A(t,s).then(()=>{const i={...c};i[d.id]={...d},p(i),b(null),L(null),E(o,h,f)}).catch(i=>{console.error("Error updating player: ",i),v("Error al guardar los cambios.")})},z=t=>{if(T(t),window.confirm(`¿Estás seguro de que deseas eliminar el jugador con ID ${t}?`)){const s=F(P,`jugadores/${t}`);R(!0),re(s).then(i=>{if(i.exists())return ae(s);throw new Error("El jugador no existe.")}).then(()=>{const i=Object.keys(c).filter(l=>l!==t).reduce((l,n)=>(l[n]=c[n],l),{});p(i),localStorage.setItem("jugadores",JSON.stringify(i)),E(o,h,f),T(null)}).catch(i=>{console.error("Error deleting player:",i),v(`Error al eliminar el jugador: ${i.message}`)}).finally(()=>{R(!1)})}},B=()=>{b(null),L(null)},J=()=>{if(window.confirm("¿Estás seguro de que deseas reiniciar el puntaje de todos los jugadores a 0?")){const d={};Object.keys(c).forEach(s=>{d[`jugadores/${s}/points`]=0}),A(F(P),d).then(()=>{const s={...c};Object.keys(s).forEach(i=>{s[i].points=0}),p(s),E(o,h,f)}).catch(s=>{console.error("Error resetting points: ",s),v("Error al reiniciar los puntajes.")})}};return e.jsxs("div",{className:"player-table-container",children:[e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",value:h,onChange:I,placeholder:"Buscar por nombre..."}),e.jsx(K,{className:"search-icon"})]}),e.jsxs("div",{className:"gender-buttons",children:[e.jsxs("button",{className:k("filter-button",{active:o==="masculino"}),onClick:()=>S("masculino"),children:[e.jsx(Q,{})," Masculino"]}),e.jsxs("button",{className:k("filter-button",{active:o==="femenino"}),onClick:()=>S("femenino"),children:[e.jsx(W,{})," Femenino"]}),e.jsx("button",{className:k("filter-button",{active:!o}),onClick:()=>S(""),children:"Mostrar Todos"})]}),e.jsxs("div",{className:"points-buttons",children:[e.jsx("button",{className:`filter-button ${f==="greater"?"active":""}`,onClick:()=>C("greater"),children:"Mayor Puntaje"}),e.jsx("button",{className:`filter-button ${f==="less"?"active":""}`,onClick:()=>C("less"),children:"Menor Puntaje"}),e.jsx("button",{className:`filter-button ${f==="zero"?"active":""}`,onClick:()=>C("zero"),children:"Puntaje 0"}),e.jsx("button",{className:`filter-button ${f?"":"active"}`,onClick:()=>C(""),children:"Mostrar Todos"}),e.jsx("button",{className:"filter-button reset-points",onClick:J,children:"Reiniciar Puntajes"})]})]}),$&&e.jsx("p",{className:"error",children:$}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"player-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Foto"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Género"}),e.jsx("th",{children:"Categoría"}),e.jsx("th",{children:"Puntos"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:t.photoURL||oe,alt:t.name,className:"player-photo"})}),e.jsx("td",{children:a&&a.id===t.id?e.jsx("input",{type:"text",name:"name",value:a.name,onChange:y}):t.name}),e.jsx("td",{children:a&&a.id===t.id?e.jsx("input",{type:"text",name:"gender",value:a.gender,onChange:y}):t.gender}),e.jsx("td",{children:a&&a.id===t.id?e.jsx("input",{type:"text",name:"category",value:a.category||"",onChange:y}):t.category||""}),e.jsx("td",{children:a&&a.id===t.id?e.jsx("input",{type:"number",name:"points",value:a.points,onChange:y}):t.points}),e.jsx("td",{children:a&&a.id===t.id?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:q,children:[e.jsx(X,{})," Guardar"]}),e.jsxs("button",{onClick:B,children:[e.jsx(Y,{})," Cancelar"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>U(t),children:[e.jsx(Z,{})," Editar"]}),e.jsx("button",{onClick:()=>z(t.id),disabled:w&&D===t.id,children:w&&D===t.id?"Eliminando...":e.jsxs(e.Fragment,{children:[e.jsx(_,{})," Eliminar"]})})]})})]},t.id))})]})})]})};export{de as default};
