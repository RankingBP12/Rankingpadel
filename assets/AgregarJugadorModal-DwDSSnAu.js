import{r as l,j as e,P as g,b as j,d as x,c as $,a as k,s as q,u as T,g as B,e as N}from"./index-BZd2uWA1.js";const D=({onClose:p,editPlayer:t,setEditPlayer:S,jugadores:v,setJugadores:f})=>{const[n,y]=l.useState(t?t.name:""),[c,C]=l.useState(null),[m,R]=l.useState(t?t.points:""),[d,I]=l.useState(t?t.gender:""),[u,E]=l.useState(t?t.category:""),[h,L]=l.useState(null),[b,F]=l.useState("");l.useEffect(()=>{(async()=>{try{const o=j(x,"jugadores/"),r=(await $(o)).val()||{},i=Object.keys(r).map(A=>r[A].id),w=i.length>0?Math.max(...i):0;L(w+1)}catch(o){console.error("Error al obtener el siguiente ID:",o)}})()},[]),l.useEffect(()=>{if(!c&&n){const s=`https://api.dicebear.com/9.x/pixel-art-neutral/svg?seed=${n.split(" ").map(r=>r[0]).join("")}`;F(s)}},[n,c]);const J=async a=>{a.preventDefault();const o=m.trim()===""?0:parseInt(m,10);if(!n||!d||!u){alert("Nombre, género y categoría son obligatorios.");return}if(isNaN(o)||o<0){alert("Los puntos deben ser un número positivo.");return}try{let s=b;if(c){const r=k(q,`jugadores/${c.name}`);await T(r,c),s=await B(r)}if(t){const r=j(x,`jugadores/${t.id}`);await N(r,{id:t.id,name:n,points:o,gender:d,category:u,photoURL:s});const i={...v};i[t.id]={id:t.id,name:n,points:o,gender:d,category:u,photoURL:s},f(i),alert("Jugador actualizado con éxito"),S(null)}else{const r=j(x,`jugadores/${h}`);await N(r,{id:h,name:n,points:o,gender:d,category:u,photoURL:s});const i={...v};i[h]={id:h,name:n,points:o,gender:d,category:u,photoURL:s},f(i),alert("Jugador guardado con éxito")}p()}catch(s){console.error("Error al guardar el jugador:",s),alert("Hubo un error al guardar el jugador.")}},O=a=>{a.target.classList.contains("agregar-jugador-modal-overlay")&&p()},U=a=>{C(a.target.files[0])};return e.jsx("div",{className:"agregar-jugador-modal-overlay",onClick:O,children:e.jsxs("div",{className:"agregar-jugador-modal-content",children:[e.jsx("button",{className:"modal-close",onClick:p,children:"×"}),e.jsx("h2",{children:t?"Editar Jugador":"Agregar Jugador"}),e.jsxs("form",{className:"agregar-jugador-form",onSubmit:J,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Nombre del Jugador"}),e.jsx("input",{id:"name",type:"text",value:n,onChange:a=>y(a.target.value),placeholder:"Ingrese el nombre del jugador",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"photo",children:"Foto del Jugador (opcional)"}),e.jsx("input",{id:"photo",type:"file",accept:"image/*",onChange:U})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"points",children:"Puntos"}),e.jsx("input",{id:"points",type:"number",value:m,onChange:a=>R(a.target.value),placeholder:"Ingrese los puntos",min:"0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"gender",children:"Género"}),e.jsxs("select",{id:"gender",value:d,onChange:a=>I(a.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un género"}),e.jsx("option",{value:"masculino",children:"Masculino"}),e.jsx("option",{value:"femenino",children:"Femenino"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"category",children:"Categoría"}),e.jsxs("select",{id:"category",value:u,onChange:a=>E(a.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),e.jsx("option",{value:"Primera",children:"Primera"}),e.jsx("option",{value:"Segunda",children:"Segunda"}),e.jsx("option",{value:"Tercera",children:"Tercera"}),e.jsx("option",{value:"Cuarta",children:"Cuarta"}),e.jsx("option",{value:"Quinta",children:"Quinta"}),e.jsx("option",{value:"Sexta",children:"Sexta"}),e.jsx("option",{value:"Septima",children:"Séptima"}),e.jsx("option",{value:"OctavaA",children:"Octava A"}),e.jsx("option",{value:"OctavaB",children:"Octava B"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"save-button",type:"submit",children:"Guardar"}),e.jsx("button",{className:"cancel-button",type:"button",onClick:p,children:"Cancelar"})]})]}),e.jsx("div",{className:"avatar-container",children:e.jsx("img",{src:c?URL.createObjectURL(c):b,alt:"Avatar",className:"avatar-image"})})]})})};D.propTypes={onClose:g.func.isRequired,editPlayer:g.object,setEditPlayer:g.func,jugadores:g.object,setJugadores:g.func};export{D as default};
