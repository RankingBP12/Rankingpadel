import{f as V,r as u,A as H,j as e,F as K,h as Q,k as W,l as X,m as Y,n as Z,o as _,b as F,d as P,a as ee,s as te,u as se,g as ne,q as L,c as ae,t as re}from"./index-BZd2uWA1.js";var O={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(p){(function(){var d={}.hasOwnProperty;function j(){for(var a="",r=0;r<arguments.length;r++){var f=arguments[r];f&&(a=h(a,g(f)))}return a}function g(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return j.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var r="";for(var f in a)d.call(a,f)&&a[f]&&(r=h(r,f));return r}function h(a,r){return r?a?a+" "+r:a+r:a}p.exports?(j.default=j,p.exports=j):window.classNames=j})()})(O);var oe=O.exports;const k=V(oe),ce=()=>{const{updateJugadores:p,jugadores:d}=u.useContext(H),[j,g]=u.useState([]),[h,a]=u.useState(""),[r,f]=u.useState(""),[m,A]=u.useState(""),[l,b]=u.useState(null),[M,w]=u.useState(!1),[$,N]=u.useState(""),[le,R]=u.useState(null),[C,E]=u.useState(null);u.useEffect(()=>{y(r,h,m)},[h,r,m,d]);const I=t=>{a(t.target.value)},S=t=>{f(t)},v=t=>{A(t)},y=(t,i,s)=>{try{let c=Object.keys(d).filter(n=>d[n]!==null&&d[n]!==void 0).map(n=>({id:d[n].id,...d[n]})).filter(n=>n.name.toLowerCase().includes(i.toLowerCase()));t&&(c=c.filter(n=>n.gender===t)),s==="greater"?c=c.filter(n=>n.points>0).sort((n,x)=>x.points-n.points):s==="less"?c=c.filter(n=>n.points>0).sort((n,x)=>n.points-x.points):s==="zero"&&(c=c.filter(n=>n.points===0).sort((n,x)=>n.name.localeCompare(x.name))),g(c)}catch(o){console.error("Error filtering players:",o),g([])}},D=t=>{const{name:i,value:s}=t.target;l&&b(o=>({...o,[i]:s}))},U=t=>{t.target.files[0]&&E(t.target.files[0])},G=t=>{b({...t})},q=()=>{if(l){const t=F(P,`jugadores/${l.id}`);if(C){const i=ee(te,`jugadores/${l.id}/photo.jpg`);se(i,C).then(s=>ne(s.ref)).then(s=>(l.photoURL=s,T(t,l))).catch(s=>{console.error("Error uploading photo: ",s),N("Error al subir la foto.")})}else T(t,l)}},T=(t,i)=>{const s={...i};C||delete s.photoURL,L(t,s).then(()=>{const o={...d};o[i.id]={...i},p(o),b(null),E(null),y(r,h,m)}).catch(o=>{console.error("Error updating player: ",o),N("Error al guardar los cambios.")})},z=t=>{if(R(t),window.confirm(`¿Estás seguro de que deseas eliminar el jugador con ID ${t}?`)){const s=F(P,`jugadores/${t}`);w(!0),ae(s).then(o=>{if(o.exists())return re(s);throw new Error("El jugador no existe.")}).then(()=>{const o=Object.keys(d).filter(c=>c!==t).reduce((c,n)=>(c[n]=d[n],c),{});p(o),localStorage.setItem("jugadores",JSON.stringify(o)),y(r,h,m),R(null)}).catch(o=>{console.error("Error deleting player:",o),N(`Error al eliminar el jugador: ${o.message}`)}).finally(()=>{w(!1)})}},B=()=>{b(null),E(null)},J=()=>{if(window.confirm("¿Estás seguro de que deseas reiniciar el puntaje de todos los jugadores a 0?")){const i={};Object.keys(d).forEach(s=>{i[`jugadores/${s}/points`]=0}),L(F(P),i).then(()=>{const s={...d};Object.keys(s).forEach(o=>{s[o].points=0}),p(s),y(r,h,m)}).catch(s=>{console.error("Error resetting points: ",s),N("Error al reiniciar los puntajes.")})}};return e.jsxs("div",{className:"player-table-container",children:[e.jsx("div",{className:"nolose",children:e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",value:h,onChange:I,placeholder:"Buscar por nombre..."}),e.jsx(K,{className:"search-icon"})]}),e.jsxs("div",{className:"gender-buttons",children:[e.jsxs("button",{className:k("filter-button",{active:r==="masculino"}),onClick:()=>S("masculino"),children:[e.jsx(Q,{})," Masculino"]}),e.jsxs("button",{className:k("filter-button",{active:r==="femenino"}),onClick:()=>S("femenino"),children:[e.jsx(W,{})," Femenino"]}),e.jsx("button",{className:k("filter-button",{active:!r}),onClick:()=>S(""),children:"Mostrar Todos"})]}),e.jsxs("div",{className:"points-buttons",children:[e.jsx("button",{className:`filter-button ${m==="greater"?"active":""}`,onClick:()=>v("greater"),children:"Mayor Puntaje"}),e.jsx("button",{className:`filter-button ${m==="less"?"active":""}`,onClick:()=>v("less"),children:"Menor Puntaje"}),e.jsx("button",{className:`filter-button ${m==="zero"?"active":""}`,onClick:()=>v("zero"),children:"Puntaje 0"}),e.jsx("button",{className:`filter-button ${m?"":"active"}`,onClick:()=>v(""),children:"Mostrar Todos"}),e.jsx("button",{className:"filter-button reset-points",onClick:J,children:"Reiniciar Puntaje"})]})]})}),$&&e.jsx("div",{className:"error-message",children:$})," ",M&&e.jsx("div",{className:"loading-message",children:"Eliminando jugador..."})," ",e.jsxs("table",{className:"player-table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"juegadores",children:[e.jsx("th",{children:"Foto"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Puntos"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:j.map((t,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:t.photoURL,alt:t.name,className:"player-photo"})}),e.jsx("td",{children:l&&l.id===t.id?e.jsx("input",{type:"text",name:"name",value:l.name||"",onChange:D,className:"editable-input"}):t.name}),e.jsx("td",{children:l&&l.id===t.id?e.jsx("input",{type:"number",name:"points",value:l.points||"",onChange:D,className:"editable-input"}):t.points}),e.jsx("td",{children:l&&l.id===t.id?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",onChange:U,accept:"image/*"}),e.jsxs("button",{className:"action-button save",onClick:q,children:[e.jsx(X,{})," Guardar"]}),e.jsxs("button",{className:"action-button cancel",onClick:B,children:[e.jsx(Y,{})," Cancelar"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"action-button edit",onClick:()=>G(t),children:[e.jsx(Z,{})," Editar"]}),e.jsxs("button",{className:"action-button delete",onClick:()=>z(t.id),children:[e.jsx(_,{})," Eliminar"]})]})})]},`${t.id}-${i}`))})]})]})};export{ce as default};
