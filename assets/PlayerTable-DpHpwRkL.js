import{i as V,r as u,A as H,j as e,F as K,k as Q,l as W,m as X,n as Y,q as Z,t as _,a as S,d as F,b as ee,s as te,u as se,c as ne,v as A,g as re,f as ae}from"./index-BfOcWkum.js";import{G as oe}from"./nombre-BYGSWZGL.js";var G={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(x){(function(){var c={}.hasOwnProperty;function f(){for(var a="",o=0;o<arguments.length;o++){var j=arguments[o];j&&(a=h(a,b(j)))}return a}function b(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return f.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var j in a)c.call(a,j)&&a[j]&&(o=h(o,j));return o}function h(a,o){return o?a?a+" "+o:a+o:a}x.exports?(f.default=f,x.exports=f):window.classNames=f})()})(G);var ie=G.exports;const k=V(ie),de=()=>{const{updateJugadores:x,jugadores:c}=u.useContext(H),[f,b]=u.useState([]),[h,a]=u.useState(""),[o,j]=u.useState(""),[m,M]=u.useState(""),[r,v]=u.useState(null),[w,R]=u.useState(!1),[T,y]=u.useState(""),[$,D]=u.useState(null),[P,L]=u.useState(null);u.useState(""),u.useEffect(()=>{E(o,h,m)},[h,o,m,c]);const I=t=>{a(t.target.value)},N=t=>{j(t)},C=t=>{M(t)},E=(t,d,s)=>{try{let l=Object.keys(c).filter(n=>c[n]!==null&&c[n]!==void 0).map(n=>({id:c[n].id,...c[n]})).filter(n=>n.name&&n.name.toLowerCase().includes(d.toLowerCase()));t&&(l=l.filter(n=>n.gender===t)),s==="greater"?l=l.filter(n=>n.points>0).sort((n,g)=>g.points-n.points):s==="less"?l=l.filter(n=>n.points>0).sort((n,g)=>n.points-g.points):s==="zero"&&(l=l.filter(n=>n.points===0).sort((n,g)=>n.name.localeCompare(g.name))),b(l)}catch(i){console.error("Error filtering players:",i),b([])}},p=t=>{const{name:d,value:s}=t.target;r&&v(i=>({...i,[d]:s}))},U=t=>{v({...t})},q=()=>{if(r){const t=S(F,`jugadores/${r.id}`);if(P){const d=ee(te,`jugadores/${r.id}/photo.jpg`);se(d,P).then(s=>ne(s.ref)).then(s=>(r.photoURL=s,O(t,r))).catch(s=>{console.error("Error uploading photo: ",s),y("Error al subir la foto.")})}else O(t,r)}},O=(t,d)=>{const s={...d,tournamentsPlayed:d.tournamentsPlayed??0};P||delete s.photoURL,A(t,s).then(()=>{const i={...c};i[d.id]=s,x(i),v(null),L(null),E(o,h,m)}).catch(i=>{console.error("Error updating player: ",i),y("Error al guardar los cambios.")})},z=t=>{if(D(t),window.confirm(`¿Estás seguro de que deseas eliminar el jugador con ID ${t}?`)){const s=S(F,`jugadores/${t}`);R(!0),re(s).then(i=>{if(i.exists())return ae(s);throw new Error("El jugador no existe.")}).then(()=>{const i=Object.keys(c).filter(l=>l!==t).reduce((l,n)=>(l[n]=c[n],l),{});x(i),localStorage.setItem("jugadores",JSON.stringify(i)),E(o,h,m),D(null)}).catch(i=>{console.error("Error deleting player:",i),y(`Error al eliminar el jugador: ${i.message}`)}).finally(()=>{R(!1)})}},J=()=>{v(null),L(null)},B=()=>{if(window.confirm("¿Estás seguro de que deseas reiniciar el puntaje de todos los jugadores a 0?")){const d={};Object.keys(c).forEach(s=>{d[`jugadores/${s}/points`]=0}),A(S(F),d).then(()=>{const s={...c};Object.keys(s).forEach(i=>{s[i].points=0}),x(s),E(o,h,m)}).catch(s=>{console.error("Error resetting points: ",s),y("Error al reiniciar los puntajes.")})}};return e.jsxs("div",{className:"player-table-container",children:[e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",value:h,onChange:I,placeholder:"Buscar por nombre..."}),e.jsx(K,{className:"search-icon"})]}),e.jsxs("div",{className:"gender-buttons",children:[e.jsxs("button",{className:k("filter-button",{active:o==="masculino"}),onClick:()=>N("masculino"),children:[e.jsx(Q,{})," Masculino"]}),e.jsxs("button",{className:k("filter-button",{active:o==="femenino"}),onClick:()=>N("femenino"),children:[e.jsx(W,{})," Femenino"]}),e.jsx("button",{className:k("filter-button",{active:!o}),onClick:()=>N(""),children:"Mostrar Todos"})]}),e.jsxs("div",{className:"points-buttons",children:[e.jsx("button",{className:`filter-button ${m==="greater"?"active":""}`,onClick:()=>C("greater"),children:"Mayor Puntaje"}),e.jsx("button",{className:`filter-button ${m==="less"?"active":""}`,onClick:()=>C("less"),children:"Menor Puntaje"}),e.jsx("button",{className:`filter-button ${m==="zero"?"active":""}`,onClick:()=>C("zero"),children:"Puntaje 0"}),e.jsx("button",{className:`filter-button ${m?"":"active"}`,onClick:()=>C(""),children:"Mostrar Todos"}),e.jsx("button",{className:"filter-button reset-points",onClick:B,children:"Reiniciar Puntajes"})]})]}),T&&e.jsx("p",{className:"error",children:T}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"player-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Foto"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Género"}),e.jsx("th",{children:"Categoría"}),e.jsx("th",{children:"Puntos"}),e.jsx("th",{children:"Torneos Jugados"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:f.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:t.photoURL||oe,alt:t.name,className:"player-photo"})}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"text",name:"name",value:r.name,onChange:p}):t.name}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"text",name:"gender",value:r.gender,onChange:p}):t.gender}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"text",name:"category",value:r.category||"",onChange:p}):t.category||""}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"number",name:"points",value:r.points,onChange:p}):t.points}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"number",name:"tournamentsPlayed",value:r.tournamentsPlayed,onChange:p}):t.tournamentsPlayed||0}),e.jsx("td",{children:r&&r.id===t.id?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:q,children:[e.jsx(X,{})," Guardar"]}),e.jsxs("button",{onClick:J,children:[e.jsx(Y,{})," Cancelar"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>U(t),children:[e.jsx(Z,{})," Editar"]}),e.jsx("button",{onClick:()=>z(t.id),disabled:w&&$===t.id,children:w&&$===t.id?"Eliminando...":e.jsxs(e.Fragment,{children:[e.jsx(_,{})," Eliminar"]})})]})})]},t.id))})]})})]})};export{de as default};
