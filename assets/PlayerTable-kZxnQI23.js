import{k as J,r as d,A as R,j as e,l as z,m as q,n as B,o as U,q as V,t as H,v as K,e as $,f as w,w as Q,h as W,x as X}from"./index-BDcw6WbW.js";var D={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(f){(function(){var c={}.hasOwnProperty;function x(){for(var s="",a=0;a<arguments.length;a++){var m=arguments[a];m&&(s=u(s,v(m)))}return s}function v(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return x.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var m in s)c.call(s,m)&&s[m]&&(a=u(a,m));return a}function u(s,a){return a?s?s+" "+a:s+a:s}f.exports?(x.default=x,f.exports=x):window.classNames=x})()})(D);var Y=D.exports;const y=J(Y),ee=()=>{const{updateJugadores:f,jugadores:c}=d.useContext(R),[x,v]=d.useState([]),[u,s]=d.useState(""),[a,m]=d.useState(""),[h,T]=d.useState(""),[r,b]=d.useState(null),[A,E]=d.useState(!1),[S,F]=d.useState(""),[Z,P]=d.useState(null);d.useEffect(()=>{C(a,u,h)},[u,a,h,c]);const I=t=>{s(t.target.value)},N=t=>{m(t)},g=t=>{T(t)},C=(t,l,j)=>{let o=Object.keys(c).map(n=>({id:c[n].id,...c[n]})).filter(n=>n.name.toLowerCase().includes(l.toLowerCase()));t&&(o=o.filter(n=>n.gender===t)),j==="greater"?o=o.filter(n=>n.points>0).sort((n,p)=>p.points-n.points):j==="less"?o=o.filter(n=>n.points>0).sort((n,p)=>n.points-p.points):j==="zero"&&(o=o.filter(n=>n.points===0).sort((n,p)=>n.name.localeCompare(p.name))),v(o)},k=t=>{const{name:l,value:j}=t.target;r&&b(i=>({...i,[l]:j}))},M=t=>{b({...t})},O=()=>{if(r){const t=$(w,`jugadores/${r.id}`);Q(t,{...r}).then(()=>{const l={...c};l[r.id]={...r},f(l),b(null),C(a,u,h)}).catch(l=>{console.error("Error updating player: ",l),F("Error al guardar los cambios.")})}},L=t=>{if(P(t),window.confirm(`¿Estás seguro de que deseas eliminar el jugador con ID ${t}?`)){console.log("ID del jugador a eliminar:",t),console.log("Datos en el contexto:",c);const j=$(w,`jugadores/${t}`);E(!0),W(j).then(i=>{if(i.exists())return console.log("Jugador encontrado en Firebase:",i.val()),X(j);throw new Error("El jugador no existe.")}).then(()=>{console.log("Jugador eliminado con éxito.");const i=Object.keys(c).filter(o=>o!==t).reduce((o,n)=>(o[n]=c[n],o),{});f(i),localStorage.setItem("jugadores",JSON.stringify(i)),C(a,u,h),P(null)}).catch(i=>{console.error("Error deleting player:",i),F(`Error al eliminar el jugador: ${i.message}`)}).finally(()=>{E(!1)})}},G=()=>{b(null)};return e.jsxs("div",{className:"player-table-container",children:[e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",value:u,onChange:I,placeholder:"Buscar por nombre..."}),e.jsx(z,{className:"search-icon"})]}),e.jsxs("div",{className:"gender-buttons",children:[e.jsxs("button",{className:y("filter-button",{active:a==="masculino"}),onClick:()=>N("masculino"),children:[e.jsx(q,{})," Masculino"]}),e.jsxs("button",{className:y("filter-button",{active:a==="femenino"}),onClick:()=>N("femenino"),children:[e.jsx(B,{})," Femenino"]}),e.jsx("button",{className:y("filter-button",{active:!a}),onClick:()=>N(""),children:"Mostrar Todos"})]}),e.jsxs("div",{className:"points-buttons",children:[e.jsx("button",{className:`filter-button ${h==="greater"?"active":""}`,onClick:()=>g("greater"),children:"Mayor Puntaje"}),e.jsx("button",{className:`filter-button ${h==="less"?"active":""}`,onClick:()=>g("less"),children:"Menor Puntaje"}),e.jsx("button",{className:`filter-button ${h==="zero"?"active":""}`,onClick:()=>g("zero"),children:"Puntaje 0"}),e.jsx("button",{className:`filter-button ${h?"":"active"}`,onClick:()=>g(""),children:"Mostrar Todos"})]})]}),S&&e.jsx("div",{className:"error-message",children:S})," ",A&&e.jsx("div",{className:"loading-message",children:"Eliminando jugador..."})," ",e.jsxs("table",{className:"player-table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"juegadores",children:[e.jsx("th",{children:"Foto"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Puntos"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:x.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:t.photoURL,alt:t.name,className:"player-photo"})}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"text",name:"name",value:r.name||"",onChange:k,className:"editable-input"}):t.name}),e.jsx("td",{children:r&&r.id===t.id?e.jsx("input",{type:"number",name:"points",value:r.points||"",onChange:k,className:"editable-input"}):t.points}),e.jsx("td",{children:r&&r.id===t.id?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"action-button save",onClick:O,children:[e.jsx(U,{})," Guardar"]}),e.jsxs("button",{className:"action-button cancel",onClick:G,children:[e.jsx(V,{})," Cancelar"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"action-button edit",onClick:()=>M(t),children:[e.jsx(H,{})," Editar"]}),e.jsxs("button",{className:"action-button delete",onClick:()=>L(t.id),children:[e.jsx(K,{})," Eliminar"]})]})})]},`${t.id}-${l}`))})]})]})};export{ee as default};
