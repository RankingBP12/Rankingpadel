import{r as c,j as e,P as p,a as v,d as f,g as k,b as A,s as D,u as G,c as q,h as y}from"./index-BfOcWkum.js";import{G as S}from"./nombre-BYGSWZGL.js";const U=({onClose:h,editPlayer:a,setEditPlayer:I,jugadores:b,setJugadores:N})=>{const[i,C]=c.useState(a?a.name:""),[g,R]=c.useState(null),[m,E]=c.useState(a?a.points:""),[d,F]=c.useState(a?a.gender:""),[u,J]=c.useState(a?a.category:""),[r,O]=c.useState(null);c.useEffect(()=>{(async()=>{try{const t=v(f,"jugadores/"),s=(await k(t)).val()||{},n=Object.keys(s).map(x=>s[x].id).filter(x=>!isNaN(x));console.log("IDs de jugadores existentes (filtrados):",n);const j=(n.length>0?Math.max(...n):0)+1;console.log("ID calculado:",j,"Tipo de dato:",typeof j),O(j)}catch(t){console.error("Error al obtener el siguiente ID:",t)}})()},[]);const w=async o=>{o.preventDefault();const t=m.trim()===""?0:parseInt(m,10);if(!i||!d||!u){alert("Nombre, género y categoría son obligatorios.");return}if(isNaN(t)||t<0){alert("Los puntos deben ser un número positivo.");return}console.log("nextId al guardar:",r,"Tipo de dato:",typeof r);try{let l=S;if(g){const s=A(D,`jugadores/${g.name}`);await G(s,g),l=await q(s)}if(a){const s=v(f,`jugadores/${a.id}`);await y(s,{id:a.id,name:i,points:t,gender:d,category:u,photoURL:l});const n={...b};n[a.id]={id:a.id,name:i,points:t,gender:d,category:u,photoURL:l},N(n),alert("Jugador actualizado con éxito"),I(null)}else{if(isNaN(r)||r<=0){console.error("nextId no es un número válido:",r);return}const s=v(f,`jugadores/${r}`);await y(s,{id:r,name:i,points:t,gender:d,category:u,photoURL:l});const n={...b};n[r]={id:r,name:i,points:t,gender:d,category:u,photoURL:l},N(n),alert("Jugador guardado con éxito")}h()}catch(l){console.error("Error al guardar el jugador:",l),alert("Se agrego correctamente")}},L=o=>{o.target.classList.contains("agregar-jugador-modal-overlay")&&h()},T=o=>{R(o.target.files[0])};return e.jsx("div",{className:"agregar-jugador-modal-overlay",onClick:L,children:e.jsxs("div",{className:"agregar-jugador-modal-content",children:[e.jsx("button",{className:"modal-close",onClick:h,children:"×"}),e.jsx("h2",{children:a?"Editar Jugador":"Agregar Jugador"}),e.jsxs("form",{className:"agregar-jugador-form",onSubmit:w,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Nombre del Jugador"}),e.jsx("input",{id:"name",type:"text",value:i,onChange:o=>C(o.target.value),placeholder:"Ingrese el nombre del jugador",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"photo",children:"Foto del Jugador (opcional)"}),e.jsx("input",{id:"photo",type:"file",accept:"image/*",onChange:T})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"points",children:"Puntos"}),e.jsx("input",{id:"points",type:"number",value:m,onChange:o=>E(o.target.value),placeholder:"Ingrese los puntos",min:"0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"gender",children:"Género"}),e.jsxs("select",{id:"gender",value:d,onChange:o=>F(o.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un género"}),e.jsx("option",{value:"masculino",children:"Masculino"}),e.jsx("option",{value:"femenino",children:"Femenino"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"category",children:"Categoría"}),e.jsxs("select",{id:"category",value:u,onChange:o=>J(o.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),e.jsx("option",{value:"Primera",children:"Primera"}),e.jsx("option",{value:"Segunda",children:"Segunda"}),e.jsx("option",{value:"Tercera",children:"Tercera"}),e.jsx("option",{value:"Cuarta",children:"Cuarta"}),e.jsx("option",{value:"Quinta",children:"Quinta"}),e.jsx("option",{value:"Sexta",children:"Sexta"}),e.jsx("option",{value:"Septima",children:"Séptima"}),e.jsx("option",{value:"OctavaA",children:"Octava A"}),e.jsx("option",{value:"OctavaB",children:"Octava B"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"save-button",type:"submit",children:"Guardar"}),e.jsx("button",{className:"cancel-button",type:"button",onClick:h,children:"Cancelar"})]})]}),e.jsx("div",{className:"avatar-container",children:e.jsx("img",{src:g?URL.createObjectURL(g):S,alt:"Avatar",className:"avatar-image"})})]})})};U.propTypes={onClose:p.func.isRequired,editPlayer:p.object,setEditPlayer:p.func,jugadores:p.object,setJugadores:p.func};export{U as default};
